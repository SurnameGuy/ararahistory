{% load static %}
<section id="artigos" style="background-color:transparent; width:100%; height: 100%; padding:10px">
  <style>
    h5, h4, h3, h2, h1 {
      font-weight: bold !important;
      font-style: bold !important;
    }

    .content {
      display: flex;
      flex-direction: column;
      align-items: center;
      height: calc(100vh - 60px);
      overflow-y: scroll;
      top: 60px;
      position: fixed;
      width: 100vw;
      padding-top: 30px;
      padding-left: 100px;
      padding-right: 100px;
      padding-bottom: 30px;
    }

    .header {
      height: 60px !important;
      width: 100%;
      position: fixed;
      background-color: #f1f1f1;
      display: flex;
      flex-direction: column;
      box-shadow: rgba(0, 0, 0, 0.16) 0px 3px 6px, rgba(0, 0, 0, 0.23) 0px 3px 6px; position: fixed; z-index: 500;
      z-index: 9999px;
    }

    .header-content {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: left;
      width: 100%;
      height: 100%;
    }

    .material-icons {
      font-family: "Material Icons" !important;
    }

    .modal p,
    a {
      font-style: normal;
      font-weight: normal;
    }

    .modal {
      min-width: 100vw;
      min-height: 100vh;
      top: 0 !important;
    }

    .modalImageContainer img {
      width: fit-content;
      height: max-content;
      height: 700px;
      object-fit: contain;
      border-radius: 5px;
      margin-top: 15px;
      margin-bottom: 15px;
    }

    .modalImageContainer {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: fit-content;
      border-radius: 5px;
      margin-bottom: 40px;
    }

    .cardImg {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-top-left-radius: 5px;
      border-top-right-radius: 5px;
    }

    .card {
      filter: brightness(100%);
      transition: filter 0.1s ease-in-out;
      border-radius: 10px;
      display: inline-grid;
      background-color: #f9f9f9;
    }

    .card:hover {
      filter: brightness(90%);
      transition: filter 0.1s ease-in-out;
    }

    #cardsContainer {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      /* Responsive columns */
      column-gap: 20px;
      width: 100%;
      height: 100%;
    }

    @media (max-width: 800px) {
      .content {
        padding-left: 10px;
        padding-right: 10px;
      }
    }    

    @media (min-width: 1200px) {

      #cardsContainer {

        grid-template-columns: repeat(4, 1fr);
        /* Four columns on large screens */

      }

    }

    @media (max-width: 800px) {
      #cardsContainer {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        /* Fewer columns for smaller screens */
      }
    }

    @media (max-width: 500px) {
      #cardsContainer {
        grid-template-columns: 1fr;
        /* Single column for very small screens */
      }
    }
  </style>
  <div id="cardsContainer">
    <script src="{% static 'js/japescript.js' %}"></script>
    <script>
      var modalOptions = {};
    
      // Função de inicialização dos modais
      function initializeModals() {
        var elems = document.querySelectorAll('.modal');
        var instances = M.Modal.init(elems, modalOptions);
      }
    
      async function loadArticles() {
        const response = await fetch("{% static 'db/articles.json' %}");
        const articlesJson = await response.json();
        console.log(articlesJson);
    
        const cardsContainer = document.getElementById('cardsContainer');
    
        for (let x = 0; x < articlesJson.length; x++) {
          var articleNumber = x
          var articleTitle = articlesJson[x]['title']
          let articleDescription = articlesJson[x]['description']
          let articleImage = articlesJson[x]['image']
          let articleContent = articlesJson[x]['content']
    
          let card = `
            <!-- CARD -->
            <div class="card">
              <div class="cardImg"><img class="cardImg" src="${articleImage}" alt="Imagem de capa do artigo.">
              </div>
              <div style="padding: 5px; height: fit-content">
                <p font-family="Poppins" style="text-align:center !important"><b>${articleTitle}</b></p>
                <p font-family="Poppins" style="text-align:center !important">${articleDescription}</p>
              </div>
              <div style="padding: 5px; height: 100%; display:flex; flex-direction: column; justify-content: flex-end">
                <div class="waves-effect waves-light btn modal-trigger" data-target="modal${articleNumber}" style="background-color: #1565c0; width: 100%">LER ARTIGO</div>
              </div>
            </div>
    
            <!-- ARTIGO -->
            <div id="modal${articleNumber}" class="modal">
              <div class="header">
                <div class="header-content">
                  <a href="#!" class="modal-close waves-effect waves-red btn-flat" style="display: flex; flex-direction: row; align-items: center; width: fit-content"><i class="material-icons" style="font-size: 30px">arrow_back</i><p style="margin-left: 15px">Voltar</p></a>
                </div>
              </div>
              <div class="content">
                  <h3>${articleTitle}</h3>
                  <p><b>${articleDescription}</b></p>
                  <div class="modalImageContainer">
                    <img src="${articleImage}">
                  </div>
                  <div>
                    ${articleContent}
                  </div>
              </div>
            </div>
          `
    
          const cardsContainer = document.getElementById('cardsContainer');
          cardsContainer.insertAdjacentHTML('beforeend', card);
        }
    
        // Inicializa os modais após adicionar todos os artigos
        initializeModals();
      };
    
      // Chama a função para carregar os artigos
      loadArticles();
    
      document.addEventListener('DOMContentLoaded', function () {
        // Inicializa os modais ao carregar a página
        initializeModals();
      });
    
    </script>
    

  </div>

</section>